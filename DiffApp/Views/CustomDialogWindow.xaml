<Window x:Class="DiffApp.Views.CustomDialogWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:fonts="clr-namespace:Fonts"
        xmlns:models="clr-namespace:DiffApp.Models"
        xmlns:converters="clr-namespace:DiffApp.Converters"
        mc:Ignorable="d"
        Title="Dialog" 
        Height="Auto" Width="400"
        SizeToContent="Height"
        WindowStyle="None"
        ResizeMode="NoResize"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False">

    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>

    <Border Background="{StaticResource BrushSurface}"
            BorderBrush="{StaticResource BrushBorder}"
            BorderThickness="1"
            CornerRadius="8"
            Margin="10">
        <Border.Effect>
            <DropShadowEffect BlurRadius="15" ShadowDepth="5" Direction="270" Color="Black" Opacity="0.2"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Padding="20,15,20,10" BorderBrush="{StaticResource BrushBorder}" BorderThickness="0,0,0,0">
                <TextBlock Text="{Binding Title}" 
                           Style="{StaticResource HeaderTextStyle}" 
                           FontSize="18"/>
            </Border>

            <Border Grid.Row="1" Padding="20,10,20,20">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" 
                               Text="{Binding IconText}"
                               FontFamily="{StaticResource MaterialIconsFont}"
                               FontSize="32"
                               VerticalAlignment="Top"
                               Margin="0,0,15,0">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Foreground" Value="{StaticResource BrushPrimary}"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IconColorKey}" Value="BrushAccent">
                                        <Setter Property="Foreground" Value="{StaticResource BrushAccent}"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IconColorKey}" Value="WarningBrush">
                                        <Setter Property="Foreground" Value="{StaticResource WarningBrush}"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IconColorKey}" Value="DangerBrush">
                                        <Setter Property="Foreground" Value="{StaticResource DangerBrush}"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <TextBlock Grid.Column="1" 
                               Text="{Binding Message}" 
                               TextWrapping="Wrap" 
                               FontSize="14" 
                               Foreground="{StaticResource TextBrush}"
                               VerticalAlignment="Center"/>
                </Grid>
            </Border>

            <Border Grid.Row="2" Background="{StaticResource BrushBackground}" CornerRadius="0,0,8,8" Padding="15">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">

                    <Button Content="OK"
                            Command="{Binding ResultCommand}"
                            CommandParameter="{x:Static models:DialogResult.Ok}"
                            Style="{StaticResource PrimaryButton}"
                            Visibility="{Binding IsOkVisible, Converter={StaticResource BooleanToVisibilityConverter}}"
                            MinWidth="80"/>

                    <StackPanel Orientation="Horizontal" Visibility="{Binding IsYesNoVisible, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button Content="Yes"
                                Command="{Binding ResultCommand}"
                                CommandParameter="{x:Static models:DialogResult.Yes}"
                                Style="{StaticResource PrimaryButton}"
                                Margin="0,0,10,0"
                                MinWidth="80"/>
                        <Button Content="No"
                                Command="{Binding ResultCommand}"
                                CommandParameter="{x:Static models:DialogResult.No}"
                                Style="{StaticResource SecondaryButton}"
                                MinWidth="80"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Visibility="{Binding IsConfirmCancelVisible, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Button Content="Confirm"
                                Command="{Binding ResultCommand}"
                                CommandParameter="{x:Static models:DialogResult.Confirm}"
                                Style="{StaticResource DangerButton}"
                                Margin="0,0,10,0"
                                MinWidth="80"/>
                        <Button Content="Cancel"
                                Command="{Binding ResultCommand}"
                                CommandParameter="{x:Static models:DialogResult.Cancel}"
                                Style="{StaticResource SecondaryButton}"
                                MinWidth="80"/>
                    </StackPanel>

                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>